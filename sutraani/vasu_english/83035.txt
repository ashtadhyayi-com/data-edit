The विसर्ग is the substitute when it is followed by a hard consonant (खर्) which itself is followed by a sibilant (शर्).
The word शर्परे is a <i>Bahuvrihi</i>, meaning that which is followed by शर् ॥ In other words, when a sibilant follows a hard consonant, the preceding <i>visarga</i> remains unchanged. Thus शशाः क्षुरम्, पुरुषः क्षुरम्, अद्भिः प्साताम्, वासः क्षौमम्, पुरुषः त्सरुः, घनाघनः क्षोभणश्चर्षणीनाम् ॥  

Though the <i>sutra</i> could have been shortened by saying शर्परे न; yet the longer form is used, in order to indicate that the <i>jihvamuliya</i> and <i>upadhmaniya</i> changes also do not take place, in cases like अद्भिः प्साताम्, वासः क्षौमम् ॥